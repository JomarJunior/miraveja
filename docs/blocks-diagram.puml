@startuml "MiraVeja - Block Diagram v0.0.1"
!theme plain

rectangle "FrontEnd" as FE #PaleGreen

rectangle "BackEnd" as BE {
    rectangle "Download" as download #LightBlue
    rectangle "FileSystem" as filesystem #LightGreen
    rectangle "Database" as database #LightYellow
    rectangle "ImageProvider" as imageprovider #LightCoral
    rectangle "Scheduler" as scheduler #LightSkyBlue
    rectangle "Embedding" as embedding #LightPink
    rectangle "ImageContent" as content #LightGray
    rectangle "Search" as search #LightSalmon

    scheduler .d..> download : "Schedules downloads"
    imageprovider -d-> download : "Retrieves images"
    
    download -d-> database : "Saves metadata"
    database -u-> download : "Retrieves metadata"

    download -d-> filesystem : "Saves image content"

    download .r.> embedding : "Triggers embedding"
    embedding -d-> database : "Saves embeddings"

    database -d-> search : "Retrieves metadata"
    filesystem --d-> content : "Retrieves content"
    embedding -d-> search : "Embeds search prompt"

    content -r-> FE : "Provides base64 image"
    search -r-> FE : "Provides image information"

    FE .u.> BE : "User interactions"
}

@enduml